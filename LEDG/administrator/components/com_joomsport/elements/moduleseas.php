<?php/*------------------------------------------------------------------------# JoomSport Professional # ------------------------------------------------------------------------# BearDev development company # Copyright (C) 2011 JoomSport.com. All Rights Reserved.# @license - http://joomsport.com/news/license.html GNU/GPL# Websites: http://www.JoomSport.com # Technical Support:  Forum - http://joomsport.com/helpdesk/-------------------------------------------------------------------------*/// no direct accessdefined( '_JEXEC' ) or die( 'Restricted access' );class JElementModuleseas extends JElement{	/**	 * Element name	 *	 * @access	protected	 * @var		string	 */	var	$_name = 'Season && group';	function fetchElement($name, $value, &$node, $control_name)	{		global $mainframe;		$db			=& JFactory::getDBO();		$doc 		=& JFactory::getDocument();		$template 	= $mainframe->getTemplate();		$fieldName	= $control_name.'['.$name.']';		$article->title = '';		$lang_val = JText::_("Display all season groups");		$query = "SELECT CONCAT(t.name,' ',s.s_name) as name,s.s_id as id FROM #__bl_tournament as t, #__bl_seasons as s WHERE s.t_id = t.id";		$db->setQuery($query);			$rows = $db->loadObjectList();				$selectbox = array();		for($i=0;$i<count($rows);$i++){			$row = $rows[$i];			$selectbox[] = JHTML::_('select.optgroup',  $row->name, 'id', 'name' ); 			$query = "SELECT group_name,id FROM #__bl_groups  WHERE s_id = ".$row->id;			$db->setQuery($query);			$gr = $db->loadObjectList();			$selectbox[] = JHTML::_('select.option',  $row->id.'|0',$lang_val, 'id', 'name' ); 			for($j=0;$j<count($gr);$j++){				$selectbox[] = JHTML::_('select.option',  $row->id.'|'.$gr[$j]->id,$gr[$j]->group_name, 'id', 'name' ); 			}		}		if(substr($joomla_v,0,3) >= '1.6'){			$javascript = 'onchange="javascript:  var myRequest = new Request({url:\'index.php?tmpl=component&option=com_joomsport&task=getparcip&sid=\'+$(\'jformparamsseason_id\').value, method: \'post\', onSuccess: function(responseText){$(\'jformparamsteam_id\').innerHTML = responseText;}}).send();"';		}else{			$javascript = 'onchange="javascript:  var myRequest = new Ajax(\'index3.php?option=com_joomsport&task=getparcip&sid=\'+$(\'paramssidgid\').value, { method: \'post\', update: $(\'paramsteam_id\')}).request();"';		}		$html = JHTML::_('select.genericlist',   $selectbox, 'params[sidgid]', 'class="inputbox" size="1" '.$javascript, 'id', 'name', $value);		//$html .= "\n".'<input type="hidden" id="'.$name.'_id" name="'.$fieldName.'" value="'.$value.'" />';				return $html;	}}